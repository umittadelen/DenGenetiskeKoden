<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://umittadelen.github.io/TextToImage/static/css/styles-new.css">
    <title>Den Genetiske Koden</title>
</head>
<body>
    <div id="all">
        <h1>Den Genetiske Koden</h1>
        <form id="generateForm" class="form">
            <div id="text-input-div" class="input-div">
                <label for="text-input">Enter Genetic Code Here:</label>
                <textarea id="text-input" name="text-input" oninput="ontextchange(event)" placeholder="enter text here (ttaatttcagatcattaa)"></textarea>
            </div>
        </form>
        <div id="result" class="form">
            <h1>Result:</h1>
            <p id="output-p"><span id="output-p-span"></span></p>
        </div>
    </div>
    <script>
        let items; // Declare items in a wider scope

        fetch('./data.json')
        .then(response => response.json())
        .then(data => {
            items = data; // Store the JSON data
        })
        .catch(error => console.error('Error loading JSON:', error));

        function ontextchange(event) {
            const outputSpan = document.getElementById('output-p-span');
            const text = event.target.value.replaceAll(' ', '').toLowerCase();
            const chunks = text.match(/.{1,3}/g) || [];
            
            // Check if the last chunk is less than 3 characters
            if (chunks.length > 0 && chunks[chunks.length - 1].length < 3) {
                outputSpan.innerHTML = `${chunks[chunks.length - 1].length} missing`;
                return;
            }

            // Map each chunk to its corresponding value from items
            const translated = chunks.map(chunk => items[chunk] || chunk);
            outputSpan.innerHTML = translated.join(' ');
        }
    </script>
</body>
</html>